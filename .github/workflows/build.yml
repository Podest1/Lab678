name: Build EXE
on:
 schedule:
  - cron: '0 0 * * 0'
 push:
  branches: [main]
 workflow_dispatch:

jobs:
 build:
  runs-on: windows-latest
  steps:
   - uses: actions/checkout@v2
   - name: Install Python
     uses: actions/setup-python@v2
     with:
      python-version: '3.9'
   - name: Install dependencies
     run: ./installResources.ps1
   - name: Build EXE
     run: pyinstaller --onefile --noconsole project.py
   - uses: actions/uploud-artifact@v3
     with:
      name: executable
      path: dist/project.exe
